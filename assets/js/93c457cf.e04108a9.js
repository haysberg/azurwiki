"use strict";(globalThis.webpackChunkazurwiki=globalThis.webpackChunkazurwiki||[]).push([[729],{919:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"selfhost/caddy","title":"Caddy","description":"Pourquoi utiliser un reverse proxy et pourquoi Caddy est utile ?","source":"@site/docs/40-selfhost/05-caddy.md","sourceDirName":"40-selfhost","slug":"/selfhost/caddy","permalink":"/azurwiki/selfhost/caddy","draft":false,"unlisted":false,"editUrl":"https://github.com/haysberg/azurwiki/tree/main/docs/docs/40-selfhost/05-caddy.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Caddy","sidebar_label":"Serveur Web - Caddy","pagination_label":"Serveur Web - Caddy","description":"Pourquoi utiliser un reverse proxy et pourquoi Caddy est utile ?","keywords":["docs","OSINT"]},"sidebar":"tutorialSidebar","previous":{"title":"DNS & Registars","permalink":"/azurwiki/selfhost/dns"},"next":{"title":"S\xe9curiser son infra","permalink":"/azurwiki/selfhost/securite"}}');var n=s(4848),i=s(8453);const o={title:"Caddy",sidebar_label:"Serveur Web - Caddy",pagination_label:"Serveur Web - Caddy",description:"Pourquoi utiliser un reverse proxy et pourquoi Caddy est utile ?",keywords:["docs","OSINT"]},a=void 0,d={},l=[];function c(e){const r={a:"a",code:"code",em:"em",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"https://caddyserver.com/",children:"Caddy"})," est un serveur web disponible sur toutes les distributions Linux, qui propose plusieurs avantages par rapport \xe0 des alternatives comme ",(0,n.jsx)(r.a,{href:"https://www.nginx.com/",children:"Nginx"})," ou ",(0,n.jsx)(r.a,{href:"https://httpd.apache.org/",children:"Apache"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["Voil\xe0 une configuration tout \xe0 fait lambda, que l'on va d\xe9cortiquer ensemble.\nCette configuration vous permettra de rendre public un dossier sur votre serveur pour pouvoir y t\xe9l\xe9charger des fichiers, ainsi qu'une instance Portainer que vous pouvez trouver dans la page d\xe9di\xe9e \xe0 ",(0,n.jsx)(r.a,{href:"/azurwiki/selfhost/docker",children:"Docker"}),"."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsxs)(r.em,{children:["Notez que le fichier de configuration par d\xe9faut pour Caddy est dans ",(0,n.jsx)(r.code,{children:"/etc/caddy/Caddyfile"}),"."]})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"files.example.net {\n        root * /chemin/des/fichiers\n        file_server browse\n}\n\nportainer.example.net {\n        reverse_proxy https://localhost:9443  {\n                transport http {\n                        tls_insecure_skip_verify\n                }\n        }\n}\n"})}),"\n",(0,n.jsx)(r.p,{children:"Dans les fichiers Caddyfile, vous n'avez pas besoin de mentionner l'adresse IP ou le port sur lequel vous allez \xe9couter les requ\xeates entrantes. \xc0 la place, vous pouvez simplement indiquer le nom de domaine (ou le sous-domaine) qui va fournir un service."}),"\n",(0,n.jsxs)(r.p,{children:["Donc au lieu d'avoir un ",(0,n.jsx)(r.code,{children:"192.168.1.12:80"})," on a les mentions de ",(0,n.jsx)(r.code,{children:"files.example.net"})," et de ",(0,n.jsx)(r.code,{children:"portainer.example.net"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"Faire \xe7a nous permet d'aller chercher un certificat TLS automatiquement, avec toute la configuration qui va bien :"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Uniquement TLS 1.2 & 1.3"}),"\n",(0,n.jsx)(r.li,{children:"Certificat valide"}),"\n",(0,n.jsx)(r.li,{children:"Redirection HTTPS automatique"}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Cette configuration nous permet d'atteindre la note de A sur ",(0,n.jsx)(r.a,{href:"https://www.ssllabs.com/ssltest/index.html",children:"SSL Labs"})," :"]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"R\xe9sultat SSL Labs avec Caddy",src:s(2963).A+"",width:"769",height:"226"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"root * /chemin/des/fichiers\n        file_server browse\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Cette partie de la configuration nous permet de cr\xe9er un explorateur de fichiers interactif dans le dossier que l'on a indiqu\xe9. Il est important de noter que sans le mot-cl\xe9 ",(0,n.jsx)(r.code,{children:"browse"})," le serveur pourra servir les fichiers mais sans l'explorateur, ce qui est int\xe9ressant si vous souhaitez servir un site static avec un ",(0,n.jsx)(r.code,{children:"index.html"})," par exemple."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"reverse_proxy https://localhost:9443  {\n                transport http {\n                        tls_insecure_skip_verify\n                }\n        }\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Cette deuxi\xe8me partie se connecte \xe0 notre container ",(0,n.jsx)(r.code,{children:"portainer"})," qui tourne en \xe9coutant sur le port 9443. En ajoutant la partie ",(0,n.jsx)(r.code,{children:"transport http"})," on peut ignorer le fait que le certificat TLS du backend soit un certificat auto-sign\xe9."]}),"\n",(0,n.jsx)(r.p,{children:"Gr\xe2ce \xe0 cette configuration, notre serveur affichera deux pages compl\xe8tement diff\xe9rentes alors que les deux services sont h\xe9berg\xe9s physiquement sur la m\xeame machine ! Pratique non ?"})]})}function u(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},2963:(e,r,s)=>{s.d(r,{A:()=>t});const t=s.p+"assets/images/ssllabs-f0e5e6bbf377ed6fb7e7f949cc684606.png"},8453:(e,r,s)=>{s.d(r,{R:()=>o,x:()=>a});var t=s(6540);const n={},i=t.createContext(n);function o(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);