"use strict";(globalThis.webpackChunkazurwiki=globalThis.webpackChunkazurwiki||[]).push([[146],{8453:(e,s,r)=>{r.d(s,{R:()=>o,x:()=>u});var i=r(6540);const n={},t=i.createContext(n);function o(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function u(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(t.Provider,{value:s},e.children)}},9542:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>a,contentTitle:()=>u,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"selfhost/securite","title":"S\xe9curiser son infra","description":"Pourquoi et comment s\xe9curiser son infra ?","source":"@site/docs/40-selfhost/06-securite.md","sourceDirName":"40-selfhost","slug":"/selfhost/securite","permalink":"/azurwiki/selfhost/securite","draft":false,"unlisted":false,"editUrl":"https://github.com/haysberg/azurwiki/tree/main/docs/docs/40-selfhost/06-securite.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"S\xe9curiser son infra","sidebar_label":"S\xe9curiser son infra","pagination_label":"S\xe9curiser son infra","description":"Pourquoi et comment s\xe9curiser son infra ?","keywords":["docs","OSINT"]},"sidebar":"tutorialSidebar","previous":{"title":"Serveur Web - Caddy","permalink":"/azurwiki/selfhost/caddy"},"next":{"title":"Docker & containers","permalink":"/azurwiki/selfhost/docker"}}');var n=r(4848),t=r(8453);const o={title:"S\xe9curiser son infra",sidebar_label:"S\xe9curiser son infra",pagination_label:"S\xe9curiser son infra",description:"Pourquoi et comment s\xe9curiser son infra ?",keywords:["docs","OSINT"]},u=void 0,a={},l=[{value:"\ud83e\uddd1 Profils utilisateurs",id:"-profils-utilisateurs",level:2},{value:"\ud83d\udd10 Utilisez un bon mot de passe / D\xe9sactivez-le",id:"-utilisez-un-bon-mot-de-passe--d\xe9sactivez-le",level:2},{value:"\ud83d\udddd\ufe0f Cl\xe9s SSH",id:"\ufe0f-cl\xe9s-ssh",level:2},{value:"\ud83e\uddf1 Pare-feu",id:"-pare-feu",level:2},{value:"\ud83d\udce5 Mises \xe0 jour",id:"-mises-\xe0-jour",level:2},{value:"\ud83d\udc33 Mettre \xe0 jour ses containers",id:"-mettre-\xe0-jour-ses-containers",level:3}];function c(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["On ne le dira jamais assez, mais ",(0,n.jsx)(s.strong,{children:"la s\xe9curit\xe9 c'est important !"})]}),"\n",(0,n.jsxs)(s.p,{children:["Si vous ne respectez pas certaines r\xe8gles basiques votre serveur sera \xe0 la merci de n'importe qui qui trouvera votre IP (",(0,n.jsx)(s.em,{children:"spoiler"})," : \xe7a n'est pas tr\xe8s compliqu\xe9)."]}),"\n",(0,n.jsx)(s.p,{children:"Voil\xe0 quelques r\xe8gles assez simples que vous pouvez suivre pour s\xe9curiser l'acc\xe8s \xe0 votre infra."}),"\n",(0,n.jsx)(s.h2,{id:"-profils-utilisateurs",children:"\ud83e\uddd1 Profils utilisateurs"}),"\n",(0,n.jsxs)(s.p,{children:['Vous entendrez souvent dire qu\'il faut absolument cr\xe9er un utilisateur "normal" non privil\xe9gi\xe9 pour ne pas faire toutes les op\xe9rations en tant que ',(0,n.jsx)(s.code,{children:"root"}),". Cela n'est pas n\xe9cessaire."]}),"\n",(0,n.jsx)(s.p,{children:"On entends surtout deux justifications pour la cr\xe9ation d'un utilisateur normal :"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:'\ud83d\udde8\ufe0f "Si tu te fais hacker le hacker ne pourra pas faire beaucoup de d\xe9gats !"'})}),"\n",(0,n.jsx)(s.p,{children:"C'est faux. M\xeame sans \xeatre administrateur, un hacker qui prendrait le contr\xf4le d'un compte utilisateur pourra tout de m\xeame supprimer l'int\xe9gralit\xe9 des documents de cet utilisateur."}),"\n",(0,n.jsxs)(s.p,{children:["De plus, la plupart des services qui sont fait pour tourner sur le r\xe9seau (LDAP, Serveur Web, etc...) ne tournent pas avec votre utilisateur ou avec ",(0,n.jsx)(s.code,{children:"root"}),", mais avec un utilisateur d\xe9di\xe9 qui poss\xe8de des droits limit\xe9s, au cas o\xf9?"]}),"\n",(0,n.jsxs)(s.p,{children:["On notera au passage que si l'utilisateur poss\xe8de les droits ",(0,n.jsx)(s.code,{children:"sudo"})," il peut faire ce qu'il veut en tant que ",(0,n.jsx)(s.code,{children:"root"}),". C'est d'ailleurs une des premi\xe8res v\xe9rifications que fera un attaquant pour effectuer une \xe9l\xe9vation de privil\xe8ges. ",(0,n.jsx)(s.em,{children:"Pourquoi chercher une faille quand on peut juste rajouter 4 lettres devant une commande ?"})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:'\ud83d\udde8\ufe0f "Si tu fais la mauvaise commande tu peux d\xe9truire ta machine !"'})}),"\n",(0,n.jsxs)(s.p,{children:["C'est plus ou moins vrai. L'habitude d'utiliser ",(0,n.jsx)(s.code,{children:"sudo"})," devant chaque commande d'administration arrivera \xe0 un moment ou \xe0 un autre."]}),"\n",(0,n.jsxs)(s.p,{children:["Ce qu'il faut comprendre ici, c'est qu'\xeatre ",(0,n.jsx)(s.code,{children:"root"})," ou faire partie du groupe ",(0,n.jsx)(s.code,{children:"sudoers"})," revient quasiment au m\xeame."]}),"\n",(0,n.jsxs)(s.p,{children:["Il est inutile voire m\xeame dangeureux de se prot\xe9ger derri\xe8re ",(0,n.jsx)(s.code,{children:"sudo"}),". Un faux sens de s\xe9curit\xe9 s'installe et ",(0,n.jsx)(s.em,{children:"hop"}),", avant qu'on s'en soit rendu compte on mine du Bitcoin sur le serveur du salon."]}),"\n",(0,n.jsx)(s.h2,{id:"-utilisez-un-bon-mot-de-passe--d\xe9sactivez-le",children:"\ud83d\udd10 Utilisez un bon mot de passe / D\xe9sactivez-le"}),"\n",(0,n.jsxs)(s.p,{children:["Si vous voulez utiliser un mot de passe pour vous connecter \xe0 votre serveur, ",(0,n.jsx)(s.strong,{children:"choisissez un mot de passe tr\xe8s long"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"Que cela soit une phrase de passe d'au moins 25 caract\xe8res m\xe9langeant minuscules, majuscules, chiffres et symboles ou bien un mot de passe que vous pourrez sauvegarder dans Bitwarden, vous ne pouvez pas vous permettre d'avoir un mot de passe de 5 caract\xe8res !"}),"\n",(0,n.jsx)(s.p,{children:"Pour \xe9viter d'avoir \xe0 le retaper plusieurs fois, il est recommand\xe9 d'utiliser des cl\xe9s SSH."}),"\n",(0,n.jsxs)(s.p,{children:["Pour d\xe9sactiver la connexion SSH sur ",(0,n.jsx)(s.code,{children:"sshd"})," vous pouvez modifier les deux param\xe8tres suivants dans ",(0,n.jsx)(s.code,{children:"/etc/ssh/sshd_config"})," :"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"PasswordAuthentication no\nPubkeyAuthentication yes\n"})}),"\n",(0,n.jsx)(s.h2,{id:"\ufe0f-cl\xe9s-ssh",children:"\ud83d\udddd\ufe0f Cl\xe9s SSH"}),"\n",(0,n.jsx)(s.p,{children:"Une cl\xe9 SSH, c'est un autre moyen de vous authentifier ! Cela permet notamment de remplacer votre mot de passe, surtout si il est tr\xe8s long."}),"\n",(0,n.jsx)(s.p,{children:"Pour g\xe9n\xe9rer une cl\xe9, vous pouvez taper la commande suivante sous Linux et MacOS :"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'ssh-keygen -t ed25519 -C "ton_email@example.com"\n'})}),"\n",(0,n.jsx)(s.admonition,{type:"caution",children:(0,n.jsx)(s.p,{children:"Vous verrez parfois des tutoriels en ligne qui utilisent l'algorithme RSA et pas l'Ed25519. Si vous n'utilisez pas de syst\xe8mes anciens qui ne fonctionnent qu'avec des cl\xe9s RSA, pr\xe9f\xe9rez toujours l'ED25519."})}),"\n",(0,n.jsxs)(s.p,{children:["Si vous avez un souci avec la g\xe9n\xe9ration de votre cl\xe9, on vous conseille le ",(0,n.jsx)(s.a,{href:"https://docs.github.com/fr/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent",children:"tutoriel de GitHub"})," pour g\xe9n\xe9rer une cl\xe9 SSH."]}),"\n",(0,n.jsx)(s.h2,{id:"-pare-feu",children:"\ud83e\uddf1 Pare-feu"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.a,{href:"https://fedoraproject.org/fr/",children:"Fedora"})," fournit par d\xe9faut ",(0,n.jsx)(s.a,{href:"https://cockpit-project.org/",children:"Cockpit"})," qui permet d'\xe9diter les r\xe8gles de votre pare-feu facilement."]}),"\n",(0,n.jsxs)(s.p,{children:["Si votre box n'est pas configur\xe9e en mode DMZ, elle ",(0,n.jsx)(s.em,{children:"devrait"})," bloquer tous les ports qui ne sont pas explicitement ouverts."]}),"\n",(0,n.jsx)(s.p,{children:"Il faut absolument bloquer tous les ports si vous n'avez pas besoin qu'ils soient joignables depuis l'ext\xe9rieur. Il suffit d'un service vuln\xe9rable sur le r\xe9seau pour que votre instance soit compromise."}),"\n",(0,n.jsx)(s.p,{children:"Il est important de noter que certains distributions Linux gardent les ports ouverts sur le r\xe9seau ! Pensez donc \xe0 bien v\xe9rifier quels ports sont ouverts sur votre machine."}),"\n",(0,n.jsx)(s.admonition,{title:"Le port SSH",type:"danger",children:(0,n.jsx)(s.p,{children:"Pensez \xe0 garder le port 22 ouvert ! Vous aurez besoin d'acc\xe9der \xe0 votre serveur. Un port 22 ferm\xe9 va vous forcer \xe0 aller vous connecter \xe0 votre terminal local avec un clavier et un \xe9cran. Pas tr\xe8s pratique quand le serveur est dans un placard sous la t\xe9l\xe9."})}),"\n",(0,n.jsx)(s.h2,{id:"-mises-\xe0-jour",children:"\ud83d\udce5 Mises \xe0 jour"}),"\n",(0,n.jsx)(s.p,{children:"Il est vital de faire vos mises \xe0 jour r\xe9guli\xe8rement !"}),"\n",(0,n.jsx)(s.p,{children:"Les mises \xe0 jour sous Linux ne ralentissent pas votre machine et permettent de r\xe9gler d'important probl\xe8mes de s\xe9curit\xe9."}),"\n",(0,n.jsxs)(s.p,{children:["Sous Debian, vous pouvez utiliser ",(0,n.jsx)(s.a,{href:"https://wiki.debian.org/fr/unattended-upgrades",children:"unattended-upgrade"}),' et sous Fedora vous pouvez configurer les mises \xe0 jour automatiques dans la cat\xe9gorie "Mises \xe0 jour de logiciel" dans Cockpit.']}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsx)(s.p,{children:"Il est important de red\xe9marrer le serveur apr\xe8s les mises \xe0 jour pour qu'elles soient r\xe9ellement utilis\xe9es."})}),"\n",(0,n.jsx)(s.h3,{id:"-mettre-\xe0-jour-ses-containers",children:"\ud83d\udc33 Mettre \xe0 jour ses containers"}),"\n",(0,n.jsxs)(s.p,{children:["Pour mettre \xe0 jour vos containers Docker automatiquement, on vous conseille d'utiliser ",(0,n.jsx)(s.a,{href:"https://containrrr.dev/watchtower/",children:"Watchtower"})," qui permet de mettre \xe0 jour des containers automatiquement d\xe8s qu'une nouvelle version est dispo."]}),"\n",(0,n.jsxs)(s.p,{children:["Pour plus d'infos, allez donc voir la page d\xe9di\xe9e \xe0 l'",(0,n.jsx)(s.a,{href:"/azurwiki/selfhost/docker",children:"administration Docker"})," !"]})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);