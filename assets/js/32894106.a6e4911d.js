"use strict";(globalThis.webpackChunkazurwiki=globalThis.webpackChunkazurwiki||[]).push([[178],{5875:(e,r,n)=>{n.d(r,{A:()=>s});const s=n.p+"assets/images/portainer-5ee6c273ee183c27888260edf5e796b5.png"},8393:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"selfhost/docker","title":"Docker & containers","description":"Pourquoi et comment acheter un nom de domaine ?","source":"@site/docs/40-selfhost/07-docker.md","sourceDirName":"40-selfhost","slug":"/selfhost/docker","permalink":"/azurwiki/selfhost/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/haysberg/azurwiki/tree/main/docs/docs/40-selfhost/07-docker.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Docker & containers","sidebar_label":"Docker & containers","pagination_label":"Docker & containers","description":"Pourquoi et comment acheter un nom de domaine ?","keywords":["docs","docker"]},"sidebar":"tutorialSidebar","previous":{"title":"S\xe9curiser son infra","permalink":"/azurwiki/selfhost/securite"},"next":{"title":"D\xe9ploiement","permalink":"/azurwiki/deploiement/"}}');var o=n(4848),t=n(8453);const i={title:"Docker & containers",sidebar_label:"Docker & containers",pagination_label:"Docker & containers",description:"Pourquoi et comment acheter un nom de domaine ?",keywords:["docs","docker"]},a=void 0,c={},l=[{value:"C&#39;est quoi Docker ?",id:"cest-quoi-docker-",level:2},{value:"Portainer : une interface Web pour Docker",id:"portainer--une-interface-web-pour-docker",level:2},{value:"Et <code>docker compose</code> ?",id:"et-docker-compose-",level:2},{value:"Les MAJs Docker avec Watchtower",id:"les-majs-docker-avec-watchtower",level:2}];function u(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.p,{children:"Installer des applications \xe0 la main, c'est le pi\xe8ge que font beaucoup de nouveaux administrateurs \xe0 la maison. C'est tellement plus rapide pour avoir un service qui tourne sur sa machine sans trop se poser de questions et il n'y a pas besoin d'apprendre une nouvelle techno pour le faire."}),"\n",(0,o.jsx)(r.p,{children:"Sauf que sur le long terme, faire les mises \xe0 jour de son service ou g\xe9rer ses services en deux clics fait gagner \xe9norm\xe9ment de temps."}),"\n",(0,o.jsxs)(r.p,{children:["Il est donc ",(0,o.jsx)(r.strong,{children:"fortement"})," recommand\xe9 que vous appreniez Docker. Certaines solutions sont design\xe9es prioritairement pour tourner sous Docker, et vous en passez va devenir de plus en plus compliqu\xe9 quand vous allez essayer de d\xe9ployer de plus en plus de services sur votre machine."]}),"\n",(0,o.jsxs)(r.p,{children:["Au passage, si vous souhaitez d\xe9ployer un service sur votre serveur, prenez le temps de voir si il est support\xe9 par ",(0,o.jsx)(r.a,{href:"https://fleet.linuxserver.io/",children:"Linuxserver.io"})," qui maintient des images Docker pour \xe9norm\xe9ment de projets !"]}),"\n",(0,o.jsx)(r.h2,{id:"cest-quoi-docker-",children:"C'est quoi Docker ?"}),"\n",(0,o.jsx)(r.p,{children:"Docker, \xe7a permet d'encapsuler une application avec toutes ses d\xe9pendances :"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Le syst\xe8me d'exploitation"}),"\n",(0,o.jsx)(r.li,{children:"Les paquets n\xe9cessaires"}),"\n",(0,o.jsx)(r.li,{children:"L'application en elle-m\xeame"}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:"L'avantage, c'est que c'est beaucoup + light que d'utiliser des machines virtuelles, tout en \xe9tant extra flexible."}),"\n",(0,o.jsx)(r.p,{children:"Cela arrange aussi \xe9norm\xe9ment les d\xe9veloppeurs de services qui peuvent fournir un seul paquet Docker et \xeatre s\xfbrs qu'il tournera sans probl\xe8me peut importe l'OS qui fait tourner le container. C'est d'ailleurs pour cela qu'il est pr\xe9f\xe9rable que vous utilisiez Docker : car c'est le format qui re\xe7oit le plus d'attention de la part des d\xe9veloppeurs la plupart du temps."}),"\n",(0,o.jsx)(r.h2,{id:"portainer--une-interface-web-pour-docker",children:"Portainer : une interface Web pour Docker"}),"\n",(0,o.jsxs)(r.p,{children:[(0,o.jsx)(r.a,{href:"https://www.portainer.io/",children:"Portainer"})," est une interface Web qui permet de g\xe9rer ses containers et ses stacks faites avec ",(0,o.jsx)(r.code,{children:"docker compose"})," facilement, ce qui aide \xe9norm\xe9ment quand il faut d\xe9ployer des services."]}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"L&#39;interface Web de Portainer",src:n(5875).A+"",width:"2554",height:"1291"})}),"\n",(0,o.jsx)(r.p,{children:"Pour l'installer, vous pouvez utiliser la commande ci-dessous."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"docker volume create portainer_data\ndocker run -d -p 8000:8000 -p 9443:9443 --name portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest\n"})}),"\n",(0,o.jsxs)(r.h2,{id:"et-docker-compose-",children:["Et ",(0,o.jsx)(r.code,{children:"docker compose"})," ?"]}),"\n",(0,o.jsxs)(r.p,{children:["Concr\xe8tement, ",(0,o.jsx)(r.code,{children:"docker compose"})," permet deux choses :"]}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Sauvegarder une longue commande Docker"}),"\n",(0,o.jsx)(r.li,{children:"D\xe9ployer plusieurs containers qui partagent le m\xeame r\xe9seau virtuel"}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:"Par exemple, ce fichier YAML permet de faire tourner une application NodeJS avec la base de donn\xe9es MongoDB n\xe9cessaire :"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-yaml",children:"version: '3'\nservices:\n  app:\n    image: node:latest\n    container_name: app_main\n    restart: always\n    command: sh -c \"yarn install && yarn start\"\n    ports:\n      - 8000:8000\n    working_dir: /app\n    volumes:\n      - ./:/app\n    environment:\n      MYSQL_HOST: localhost\n      MYSQL_USER: root\n      MYSQL_PASSWORD: \n      MYSQL_DB: test\n  mongo:\n    image: mongo\n    container_name: app_mongo\n    restart: always\n    ports:\n      - 27017:27017\n    volumes:\n      - ~/mongo:/data/db\nvolumes:\n  mongodb:\n"})}),"\n",(0,o.jsx)(r.h2,{id:"les-majs-docker-avec-watchtower",children:"Les MAJs Docker avec Watchtower"}),"\n",(0,o.jsx)(r.p,{children:"Watchtower est un outil permettant de mettre \xe0 jour automatiquement vos containers Docker. Le syst\xe8me de tag de Docker est pratique, mais uniquement si vous utilisez des mises \xe0 jours automatiques."}),"\n",(0,o.jsxs)(r.p,{children:["Par exemple, un container qui utilise le tag ",(0,o.jsx)(r.code,{children:"latest"})," ne sera pas mis \xe0 jour automatiquement pour correspondre \xe0 la derni\xe8re version en date."]}),"\n",(0,o.jsx)(r.admonition,{type:"tip",children:(0,o.jsxs)(r.p,{children:["Cela vaut aussi pour les autres tags, pas uniquement ",(0,o.jsx)(r.code,{children:"latest"}),"."]})}),"\n",(0,o.jsx)(r.p,{children:"Vous t\xe9l\xe9chargez le container une fois et le d\xe9ployez, mais si une nouvelle version sort pour corriger une faille de s\xe9curit\xe9 majeure, vous devrez tout faire vous m\xeame, et \xe7a peut devenir compliqu\xe9 quand vous avez plusieurs dizaines de containers qui tournent sur votre machine."}),"\n",(0,o.jsxs)(r.p,{children:["Watchtower nous permet de r\xe9gler le probl\xe8me et de mettre \xe0 jour tous nos containers en un claquement de doigts. Il suffit juste de l'installer avec le fichier ",(0,o.jsx)(r.code,{children:"docker compose"})," suivant :"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-yaml",children:'version: "3"\nservices:\n  watchtower:\n    container_name: watchtower\n    image: containrrr/watchtower\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n    restart: unless-stopped\n    environment:\n      - WATCHTOWER_POLL_INTERVAL=3600 #Pour v\xe9rifier les mises \xe0 jour \xe0 toutes les heures\n'})})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>a});var s=n(6540);const o={},t=s.createContext(o);function i(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);